[toc]
# Graph
## 储存方式
### 邻接矩阵
$$\text{矩阵 }A \qquad(n,n)\\
A[i,j]=1 \iff i \text{ 和 }j \text{ 间有边}$$
### 邻接表
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20141722.png)
## DFS
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20142523.png)
考虑可能不强连通，多次开始
$$O(m)$$
### 求无向图连通分量
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20143844.png)
### （prev标号，post标号）
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20144354.png)
### 判断一个图是不是DAG
看dfs中是否会碰到（有虚边）之前访问过的点
### 拓扑排序
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20145737.png)
发现事实：$$\begin{aligned}
    \text{post}[A]&>\text{post}[B]\\
\iff  A&\to B
\end{aligned}$$
即直接dfs，然后按照后续标号从大到小遍历，即为拓扑排序
### 求图的强连通分量
Strong Connected Conponents
两个点强连通：两个点互相可到达
在强连通分量中，任意两个点强连通
极大强连通分量：再加入任意一个点，不再是强连通分量
#### meta graph
将图中的强连通分量变为一个点得到的图，一定是DAG
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20150642.png)
#### 一个性质
post最大的点一定在 meta graph 中的“源”中
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20165434.png)
#### 算法
在边反向图上dfs求post值，再按照post从大到小dfs
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20165950.png)
## BFS
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20174413.png)
$$O(|V|+|E|)$$
### 无权图最短路径
在没有边权的图上用BFS求最短路：BFS的层数就是该点到 $s$ 的最短距离
### 有权图最短路径
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20174859.png)
但是慢，改进成Dijkstra算法
### Dijkstra算法
<div>边权不能是<t style="color:red;">负数</t></div>

![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20175556.png)
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20180128.png)
#### 正确性证明
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20180720.png)
#### 时间复杂度
$$O(|V|\cdot\text{[time for popmin]}+|E|\cdot\text{[time for change]})$$
二叉堆实现，popmin和change都是$O(\log|V|)$
$$O((|V|+|E|)\log|V|)$$
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20181812.png)

## Bellman-Ford
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20202232.png)
$$O(|V|\cdot|E|)$$
### 判断是否有负环
如果没有负环的话，$|V|-1$ 次update后不应该有改变，如果第$|V|$次仍然有update，则有负环
### 在DAG上如何优化
![](./img2/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-06-12%20202914.png)
$$O(|V|+|E|)$$